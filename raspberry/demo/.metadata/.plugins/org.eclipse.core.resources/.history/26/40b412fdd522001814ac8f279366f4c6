package bs.pi.gateway.sender;

import java.io.IOException;
import java.io.OutputStream;
import java.util.HashMap;

public class PortSender implements ISender {

	public final String NAME = "PortSender";
	private OutputStream oStream;
	
	public PortSender(OutputStream oStream){
		this.oStream = oStream;
	}
	
	@Override
	public String getName() {
		// TODO Auto-generated method stub
		return NAME;
	}

	@Override
	public HashMap<String, Object> send(HashMap<String, Object> msg) {
		
		HashMap<String, Object> result = new HashMap<String, Object>();
		result.put(ISender.KEY_SEND_RESULT, ISender.KEY_SEND_RESULT_FAIL);
		
		if(msg.containsKey("data")){
			byte[] data = (byte[]) msg.get("data");
			if(data != null && data.length>0){
				try {
					oStream.write(data);
					result.put(ISender.KEY_SEND_RESULT, ISender.KEY_SEND_RESULT_SUCCESS);
				} catch (IOException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
					result.put(ISender.KEY_SEND_RESULT, ISender.KEY_SEND_RESULT_FAIL);
				}
			}
		}
		return result;
	}

}
