package bs.pi.gateway.assist;

import java.io.ByteArrayInputStream;
import java.io.DataInputStream;
import java.io.IOException;

public class Tool {
	
	private final static String HEX_STR = "0123456789ABCDEF";
	
	private static byte charsToByte(char highC, char lowC){
		highC = Character.toUpperCase(highC);
		lowC = Character.toUpperCase(lowC);
		byte high = (byte)((HEX_STR.indexOf(highC))<<4);
		byte low = (byte)HEX_STR.indexOf(lowC);
		byte result = (byte) (high|low);
		return result;
	}
	
	public static byte strToByte(String str){
		return charsToByte(str.charAt(0), str.charAt(1));
	}
	
	public static short strToShort(String str){
		short b1 = charsToByte(str.charAt(0), str.charAt(1));
		short b2 = charsToByte(str.charAt(2), str.charAt(3));
		short result = (short) ((short)(b1*256)+b2);
		return result;
	}
	
	public static byte[] strToBytes(String str){
		int len = str.length()/2;
		byte[] bytes = new byte[len];
		for(int i=0;i<len;i++){
			bytes[i] = charsToByte(str.charAt(2*i), str.charAt(2*i+1));
		}
		return bytes;
	}
	
	public static float bytesToFloat(byte[] valueBytes) throws Exception{
		if(valueBytes.length != 4)
			throw new Exception("bytesToFloat error");
		
		DataInputStream dis=new DataInputStream(new ByteArrayInputStream(valueBytes));
		float value = dis.readFloat();
		dis.close();
		
		return value;
	}
}
